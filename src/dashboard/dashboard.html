<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh" content="{refresh}">
    <title>{title}</title>
    <style>
:root {{
    --bg-primary: #0f172a;
    --bg-secondary: #1e293b;
    --bg-tertiary: #334155;
    --text-primary: #f1f5f9;
    --text-secondary: #94a3b8;
    --accent-green: #22c55e;
    --accent-yellow: #eab308;
    --accent-red: #ef4444;
    --accent-blue: #3b82f6;
    --accent-purple: #a855f7;
}}

* {{
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}}

body {{
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    min-height: 100vh;
    padding: 2rem;
}}

.container {{
    max-width: 1400px;
    margin: 0 auto;
}}

header {{
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--bg-tertiary);
}}

h1 {{
    font-size: 1.75rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.75rem;
}}

.logo {{
    width: 32px;
    height: 32px;
    background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
    border-radius: 8px;
}}

.status-badge {{
    padding: 0.5rem 1rem;
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 500;
}}

.status-healthy {{
    background: rgba(34, 197, 94, 0.2);
    color: var(--accent-green);
}}

.status-degraded {{
    background: rgba(234, 179, 8, 0.2);
    color: var(--accent-yellow);
}}

.status-unhealthy {{
    background: rgba(239, 68, 68, 0.2);
    color: var(--accent-red);
}}

.grid {{
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}}

.card {{
    background: var(--bg-secondary);
    border-radius: 12px;
    padding: 1.5rem;
    border: 1px solid var(--bg-tertiary);
}}

.card-title {{
    font-size: 0.875rem;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.75rem;
}}

.card-value {{
    font-size: 2.25rem;
    font-weight: 700;
    color: var(--text-primary);
}}

.card-subtitle {{
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin-top: 0.25rem;
}}

.metrics-grid {{
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}}

.metric {{
    background: var(--bg-tertiary);
    padding: 1rem;
    border-radius: 8px;
}}

.metric-label {{
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin-bottom: 0.25rem;
}}

.metric-value {{
    font-size: 1.25rem;
    font-weight: 600;
}}

.components {{
    margin-top: 2rem;
}}

.component {{
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    background: var(--bg-tertiary);
    border-radius: 8px;
    margin-bottom: 0.5rem;
}}

.component-name {{
    font-weight: 500;
}}

.component-status {{
    display: flex;
    align-items: center;
    gap: 0.5rem;
}}

.status-dot {{
    width: 8px;
    height: 8px;
    border-radius: 50%;
}}

.status-dot.healthy {{
    background: var(--accent-green);
}}

.status-dot.degraded {{
    background: var(--accent-yellow);
}}

.status-dot.unhealthy {{
    background: var(--accent-red);
}}

footer {{
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 1px solid var(--bg-tertiary);
    display: flex;
    justify-content: space-between;
    color: var(--text-secondary);
    font-size: 0.75rem;
}}

.links a {{
    color: var(--accent-blue);
    text-decoration: none;
    margin-left: 1rem;
}}

.links a:hover {{
    text-decoration: underline;
}}
    </style>
</head>
<body>
    <div class="container">
<header>
    <h1>
        <div class="logo"></div>
        {title}
    </h1>
    <span class="status-badge status-{status_class}">{status}</span>
</header>

<div class="grid">
    <div class="card">
        <div class="card-title">Uptime</div>
        <div class="card-value">{uptime}</div>
        <div class="card-subtitle">Since last restart</div>
    </div>

    <div class="card">
        <div class="card-title">Policy Evaluations</div>
        <div class="card-value">{policy_total}</div>
        <div class="card-subtitle">{policy_allowed} allowed / {policy_denied} denied</div>
    </div>

    <div class="card">
        <div class="card-title">Tool Executions</div>
        <div class="card-value">{tool_total}</div>
        <div class="card-subtitle">{tool_success} success / {tool_failure} failure</div>
    </div>

    <div class="card">
        <div class="card-title">Active Agents</div>
        <div class="card-value">{active_agents}</div>
        <div class="card-subtitle">{active_sessions} active sessions</div>
    </div>
</div>

<div class="card">
    <div class="card-title">Metrics Overview</div>
    <div class="metrics-grid">
        <div class="metric">
            <div class="metric-label">Audit Entries</div>
            <div class="metric-value">{audit_entries}</div>
        </div>
        <div class="metric">
            <div class="metric-label">PRM Evaluations</div>
            <div class="metric-value">{prm_evaluations}</div>
        </div>
        <div class="metric">
            <div class="metric-label">Backtrack Triggers</div>
            <div class="metric-value">{prm_backtracks}</div>
        </div>
        <div class="metric">
            <div class="metric-label">WASM Executions</div>
            <div class="metric-value">{wasm_executions}</div>
        </div>
        <div class="metric">
            <div class="metric-label">Skills Loaded</div>
            <div class="metric-value">{skills_loaded}</div>
        </div>
        <div class="metric">
            <div class="metric-label">Memory Usage</div>
            <div class="metric-value">{memory_usage}</div>
        </div>
    </div>
</div>

<div class="card components">
    <div class="card-title">Component Health</div>
    {components_html}
</div>

<footer>
    <div>VAK v{version} â€¢ Auto-refresh every {refresh}s</div>
    <div class="links">
        <a href="/metrics">Prometheus Metrics</a>
        <a href="/health">Health JSON</a>
        <a href="/ready">Readiness</a>
        <a href="/api/stats">API Stats</a>
    </div>
</footer>
    </div>

    <script>
// Auto-refresh handled by meta tag
console.log('VAK Dashboard loaded');
    </script>
</body>
</html>
